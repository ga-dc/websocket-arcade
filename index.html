<!DOCTYPE html>
<html data-ng-app="connect4">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.0-beta.2/angular-resource.min.js"></script>
  </head>
  <body data-ng-controller="BoardController as vm">
    <div class="board">
      <div class="piece" data-ng-repeat="piece in vm.pieces">
        X: {{piece.x}}
        Y: {{piece.y}}
        Color: {{piece.color}}
      </div>
    </div>
    <form data-ng-submit="vm.createPiece()">
      <button type="submit">Create New Piece</button>
    </form>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io()
      angular
        .module("connect4", [])
        .controller("BoardController", [
          "$scope",
          BoardControllerFunction
        ])

      function BoardControllerFunction($scope){
        vm = this
        vm.pieces = [{x: 2, y: 4, color: "blue"}]
        vm.createPiece = function() {
          let newPiece = {}
          newPiece.x = 1
          newPiece.y = 2
          newPiece.color = "blue"
          socket.emit('add piece', newPiece)
        }
        socket.on('add piece', piece => {
          vm.pieces.push(piece)
          $scope.$apply()
        })
      }
    </script>
  </body>
</html>
